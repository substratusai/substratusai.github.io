"use strict";(self.webpackChunksubstratus_website=self.webpackChunksubstratus_website||[]).push([[5488],{4750:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=s(5893),r=s(1151);const o={sidebar_position:2},a="GCP - Google Cloud",l={id:"quickstart/gcp",title:"GCP - Google Cloud",description:"In this quickstart guide, you will create a Kubernetes Cluster on Google Cloud and install Substratus. By the end you will have the Open Source Falcon 7B model deployed and ready to interact with.",source:"@site/docs/quickstart/gcp.md",sourceDirName:"quickstart",slug:"/quickstart/gcp",permalink:"/docs/quickstart/gcp",draft:!1,unlisted:!1,editUrl:"https://github.com/substratusai/substratusai.github.io/tree/main/docs/quickstart/gcp.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Local - Kind",permalink:"/docs/quickstart/local-kind"},next:{title:"Overview",permalink:"/docs/overview"}},i={},c=[{value:"Required Tools",id:"required-tools",level:2},{value:"Setup",id:"setup",level:2},{value:"Deploy LLM",id:"deploy-llm",level:2},{value:"Talk to your LLM!",id:"talk-to-your-llm",level:2},{value:"Cleanup",id:"cleanup",level:2}];function u(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"gcp---google-cloud",children:"GCP - Google Cloud"}),"\n",(0,n.jsx)(t.p,{children:"In this quickstart guide, you will create a Kubernetes Cluster on Google Cloud and install Substratus. By the end you will have the Open Source Falcon 7B model deployed and ready to interact with."}),"\n",(0,n.jsx)(t.admonition,{type:"note",children:(0,n.jsxs)(t.p,{children:["Support for AWS (",(0,n.jsx)(t.a,{href:"https://github.com/substratusai/substratus/issues/12",children:"GitHub Issue #12"}),") and Azure (",(0,n.jsx)(t.a,{href:"https://github.com/substratusai/substratus/issues/63",children:"GitHub Issue #63"}),") is planned. Give those issues a thumbs up if you would like to see them prioritized."]})}),"\n",(0,n.jsx)(t.h2,{id:"required-tools",children:"Required Tools"}),"\n",(0,n.jsx)(t.p,{children:"Make sure you have the following tools installed and up to date."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://cloud.google.com/sdk/docs/install",children:"gcloud"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/tasks/tools/#kubectl",children:"kubectl"})}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"setup",children:"Setup"}),"\n",(0,n.jsxs)(t.p,{children:["You will need a ",(0,n.jsx)(t.a,{href:"https://console.cloud.google.com/",children:"Google Cloud Platform"})," project with billing enabled."]}),"\n",(0,n.jsx)(t.p,{children:"Set your current project to the project you want to use for Substratus:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"gcloud config set project <your-project-id>\nexport PROJECT_ID=$(gcloud config get project)\n"})}),"\n",(0,n.jsx)(t.p,{children:"Create a GKE cluster along with supporting infrastructure (buckets, service accounts, image registries) and install Substratus operator by using the convenience script:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"bash <(curl https://raw.githubusercontent.com/substratusai/substratus/main/install/gcp/up.sh)\n"})}),"\n",(0,n.jsxs)(t.p,{children:["After creating the GKE cluster in the last step, ",(0,n.jsx)(t.code,{children:"kubectl"})," should now be pointing at the Substratus cluster. The substratus operator has been installed into the ",(0,n.jsx)(t.code,{children:"substratus"})," namespace."]}),"\n",(0,n.jsx)(t.h2,{id:"deploy-llm",children:"Deploy LLM"}),"\n",(0,n.jsx)(t.p,{children:"The following Model object will import the medium-sized Falcon 7B Instruct model (7 billion parameters) from HuggingFace."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:"apiVersion: substratus.ai/v1\nkind: Model\nmetadata:\n  name: falcon-7b-instruct\nspec:\n  image: substratusai/model-loader-huggingface\n  params:\n    name: tiiuae/falcon-7b-instruct\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/substratusai/substratus/main/examples/falcon-7b-instruct/base-model.yaml\n"})}),"\n",(0,n.jsx)(t.p,{children:"The model is now being downloaded from HuggingFace into the Substratus GCS bucket. This takes about 5 minutes. You can apply the following Server object to start serving the Model once it is loaded."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",children:'apiVersion: substratus.ai/v1\nkind: Server\nmetadata:\n  name: falcon-7b-instruct\nspec:\n  image: substratusai/model-server-basaran\n  model:\n    name: falcon-7b-instruct\n  env:\n    MODEL_LOAD_IN_8BIT: "true"\n  resources:\n    gpu:\n      type: nvidia-l4\n      count: 1\n'})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/substratusai/substratus/main/examples/falcon-7b-instruct/server.yaml\n"})}),"\n",(0,n.jsx)(t.p,{children:"You can check on the progress of both processes using the following command."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl get ai\n"})}),"\n",(0,n.jsxs)(t.p,{children:["When the Server reports a ",(0,n.jsx)(t.code,{children:"Ready"})," status, proceed to the next section to test it out."]}),"\n",(0,n.jsx)(t.h2,{id:"talk-to-your-llm",children:"Talk to your LLM!"}),"\n",(0,n.jsx)(t.p,{children:"In order to access the model for exploratory purposes, forward ports from within the cluster to your local machine."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl port-forward service/falcon-7b-instruct-server 8080:8080\n"})}),"\n",(0,n.jsxs)(t.p,{children:["All substratus Servers ship with an API and interactive frontend. Open up your browser to ",(0,n.jsx)(t.a,{href:"http://localhost:8080/",children:"http://localhost:8080/"})," and talk to your model! Alternatively, request text generation via the OpenAI compatible HTTP API:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'curl http://localhost:8080/v1/completions \\\n  -H "Content-Type: application/json" \\\n  -d \'{ \\\n    "model": "falcon-7b-instruct", \\\n    "prompt": "Who was the first president of the United States? ", \\\n    "max_tokens": 10\\\n  }\'\n'})}),"\n",(0,n.jsx)(t.p,{children:"The process that is serving the model can be stopped by simply deleting the same Server object that was applied before."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"kubectl delete server falcon-7b-instruct\n"})}),"\n",(0,n.jsx)(t.h2,{id:"cleanup",children:"Cleanup"}),"\n",(0,n.jsx)(t.p,{children:"Delete all GCP infrastructure."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"bash <(curl https://raw.githubusercontent.com/substratusai/substratus/main/install/gcp/down.sh)\n"})}),"\n",(0,n.jsxs)(t.p,{children:["If you are interested in continuing your journey through Substratus, take a look at the ",(0,n.jsx)(t.a,{href:"../category/guides",children:"guides"})," to learn how to finetune models with your own dataset and much more!"]}),"\n",(0,n.jsxs)(t.p,{children:["To learn more about how Substratus works, check out the ",(0,n.jsx)(t.a,{href:"/docs/overview",children:"Overview"})," page."]})]})}function d(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},1151:(e,t,s)=>{s.d(t,{Z:()=>l,a:()=>a});var n=s(7294);const r={},o=n.createContext(r);function a(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);